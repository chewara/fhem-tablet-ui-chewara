"use strict";!function(t){t.fn.famultibutton=function(e){function b(){n=!0,i.children().filter("#bg").css("color",v.onBackgroundColor),i.children().filter("#fg").css("color",v.onColor),i.trigger("setOn")}function $(){n=!1,i.children().filter("#bg").css("color",v.offBackgroundColor),i.children().filter("#fg").css("color",v.offColor),i.trigger("setOff")}function S(){n&&(n=!1,t("<div />").animate({width:100},{duration:700,easing:"swing",step:function(t,e){var n=(t-e.start)/(e.end-e.start);i.children().filter("#bg").css("color",y(v.onBackgroundColor,v.offBackgroundColor,n)),i.children().filter("#fg").css("color",y(v.onColor,v.offColor,n))}}))}function w(t){var e=t.match(/^rgba?[\s+]?\([\s+]?(\d+)[\s+]?,[\s+]?(\d+)[\s+]?,[\s+]?(\d+)[\s+]?/i);return e&&4===e.length?"#"+("0"+parseInt(e[1],10).toString(16)).slice(-2)+("0"+parseInt(e[2],10).toString(16)).slice(-2)+("0"+parseInt(e[3],10).toString(16)).slice(-2):t}function y(t,e,i){t=w(t).replace(/^\s*#|\s*$/g,""),e=w(e).replace(/^\s*#|\s*$/g,""),3==t.length&&(t=t.replace(/(.)/g,"$1$1")),3==e.length&&(e=e.replace(/(.)/g,"$1$1"));var n=parseInt(t.substr(0,2),16),a=parseInt(t.substr(2,2),16),o=parseInt(t.substr(4,2),16),r=parseInt(e.substr(0,2),16),s=parseInt(e.substr(2,2),16),l=parseInt(e.substr(4,2),16),f=r-n,u=s-a,c=l-o;return f=(f*i+n).toString(16).split(".")[0],u=(u*i+a).toString(16).split(".")[0],c=(c*i+o).toString(16).split(".")[0],1==f.length&&(f="0"+f),1==u.length&&(u="0"+u),1==c.length&&(c="0"+c),"#"+f+u+c}function I(e){var n=i.find("canvas#progress");if(e>0){0===n.length&&(n=t("<canvas>").attr({id:"progress"}).appendTo(i));var a=n[0];if(a){a.height=i.height(),a.width=i.width();var o=a.width/2,r=a.height/2;if(a.getContext){var s=a.getContext("2d");s.beginPath(),s.strokeStyle=v.onColor,s.arc(o,r,o*(-.4/90*Number(v.progressWidth)+.8),-.5*Math.PI,(-.5+2*e)*Math.PI,!1),s.lineWidth=.8*o*v.progressWidth/100,s.stroke()}}}else i.find("canvas#progress").remove()}function P(){clearTimeout(o),f=u>0?f-=v.step:f+=v.step,f>v.max&&(f=v.max),f<v.min&&(f=v.min),x();var t=s[Math.abs(u)];o=setTimeout(function(){P()},500-t)}function x(){var t=a[0];if(t.height=i.innerHeight(),t.width=i.innerWidth(),t.getContext){var e=t.getContext("2d");e.strokeStyle=v.offBackgroundColor;for(var o=v.max,r=v.min,s=t.height-Math.round(t.height*(f-r)/(o-r)),l=0;l<t.height;l+=4)e.lineWidth=1,e.beginPath(),e.moveTo(5,l),e.lineTo(25,l),e.stroke();e.strokeStyle=n?v.onBackgroundColor:y(v.offBackgroundColor,"#ffffff",.4),e.lineWidth=3,e.beginPath(),e.moveTo(5,s),e.lineTo(25,s),e.stroke(),e.fillStyle=y(v.offBackgroundColor,"#ffffff",.4),e.font="10px sans-serif",e.fillText(f,30,t.height)}}function D(){a.css({position:"absolute","z-index":-1}),g?a.animate({left:.6*-i.innerWidth()+"px"}):a.animate({left:i.innerWidth()/5+"px",top:c})}function T(t){t=(t||navigator.userAgent).toLowerCase();var e=t.match(/android\s([0-9\.]*)/);return e?e[1]:!1}if(this.length>1)return this.each(function(){t(this).famultibutton(e)}),this;var a,o,O,M,i=this,n=!1,r=!1,s=[0,10,40,80,120,140,150,160,180,200,240,260,280,300,320,420,430,440,450,460,470],l=0,f=0,u=0,c=0,d=0,g=!1,h=!1,p={backgroundIcon:"fa-circle",classes:["fa-2x"],icon:"fa-power-off",offColor:"#2A2A2A",offBackgroundColor:"#505050",onColor:"#2A2A2A",onBackgroundColor:"#aa6900",mode:"toggle",toggleOn:null,toggleOff:null,valueChanged:null,progressWidth:15,max:100,min:0,step:1},v=t.extend({},p,e),m=function(){if(v=t.extend({},v,i.data()),i.addClass("fa-stack"),jQuery("<i/>",{id:"bg","class":"fa fa-stack-2x"}).addClass(v.backgroundIcon).appendTo(i),jQuery("<i/>",{id:"fg","class":"fa fa-stack-1x"}).addClass(v.icon).appendTo(i),v.classes&&v.classes.length>0)for(var e=0;e<v.classes.length;e++)i.addClass(v.classes[e]);return $(),"dimmer"==v.mode&&(t("<canvas>").attr({id:"scale"}).appendTo(i),a=i.find("canvas#scale"),a.css({height:i.innerHeight()+4}),c=parseInt(a.offset().top)-parseInt(i.offset().top),x(),D()),i.o=v,i.data("famultibutton",i),i},C=T(),k=C&&parseFloat(C)<5,L=k?"touchstart":"touchstart mousedown",R=k?"touchmove":"touchmove mousemove",E=k?"touchend":"touchend mouseup",F=k?"touchleave":"touchleave mouseout";return"push"==v.mode?(this.on(L,function(e){e.preventDefault(),e.stopImmediatePropagation(),M=t(window).scrollTop(),O=t(window).scrollLeft()}),this.on(E,function(e){if(e.preventDefault(),e.stopImmediatePropagation(),!(Math.abs(M-t(window).scrollTop())>3||Math.abs(O-t(window).scrollLeft())>3)){var a=n;return b(),"function"==typeof v.toggleOn&&v.toggleOn.call(this),setTimeout(function(){S()},200),a===!0&&setTimeout(function(){b()},1e3),i.trigger("clicked"),!1}})):"toggle"==v.mode?(this.on(L,function(e){e.preventDefault(),e.stopImmediatePropagation(),M=t(window).scrollTop(),O=t(window).scrollLeft()}),this.on(E,function(e){return e.preventDefault(),e.stopImmediatePropagation(),Math.abs(M-t(window).scrollTop())>3||Math.abs(O-t(window).scrollLeft())>3?void 0:(n?($(),"function"==typeof v.toggleOff&&v.toggleOff.call(this)):(b(),"function"==typeof v.toggleOn&&v.toggleOn.call(this)),i.trigger("clicked"),!1)})):"dimmer"==v.mode&&(this.on(L,function(t){t.preventDefault(),t.stopImmediatePropagation();var e=t.originalEvent;l=e.touches?e.touches[0].clientY:t.pageY,u=0,h=!0}),this.on(F,function(t){t.preventDefault(),t.stopImmediatePropagation(),g&&(g=!1,i.animate({top:0}),clearInterval(o),r=!1,D()),h=!1}),this.on(E,function(t){return t.preventDefault(),t.stopImmediatePropagation(),g?(g=!1,i.animate({top:0}),clearTimeout(o),r=!1,"function"==typeof v.valueChanged&&v.valueChanged.call(this,f)):n?($(),"function"==typeof v.toggleOff&&v.toggleOff.call(this)):(b(),"function"==typeof v.toggleOn&&v.toggleOn.call(this)),g=!1,h=!1,D(),x(),i.trigger("clicked"),!1}),this.on(R,function(t){t.preventDefault(),t.stopImmediatePropagation(),h&&(g=!0);var e=t.originalEvent;d=e.touches?e.touches[0].clientY:t.pageY,u=d-l,u>20&&(u=20),-20>u&&(u=-20),g&&(this.style.top=u+"px",r||(D(),P(),r=!0),a.css({top:-u+"px"}))})),this.setOn=function(){b()},this.setOff=function(){$()},this.getState=function(){return n},this.getValue=function(){return f},this.setDimValue=function(t){f=t,x()},this.setProgressValue=function(t){I(t)},m()}}(jQuery);